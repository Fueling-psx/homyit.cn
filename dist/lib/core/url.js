define(function(require,exports,module){exports.setHashParam=function(t,a){var r=location.hash,e=new RegExp("^(.*[#|&])"+t+"=([^&]*)(.*)$"),h=r.replace(e,"$1"+t+"="+a+"$3");h!==r&&(location.hash=h)},exports.get=function(t,a){if(a=a||location.href,!t)return a;if("?"===t.charAt(0)||"#"===t.charAt(0)){var r={},e=t.split(t.charAt(0))[1],h="?"===t.charAt(0)?/.*\?([^#]+).*/:/.*#(.+)/,n=h.test(a)&&a.replace(h,"$1");if(n)for(var i,o=n.split("&"),s=0,l=o.length;s<l;s++)o[s].indexOf("=")!==-1&&(i=o[s].split("="),r[i[0]]=i[1]||"");return e?r[e]||"":r}if($.inArray(t,["host","port","path","query","fragment","hash","all"])){var f=arguments[1]?a.match(/([^\/]*\/\/:)?([^(\/\?#)]*)(\/?[^(\?#)]*)\??([^#]*)#?(.*)/):window.location,p={};if(arguments[1]){var c=f[1]&&f[2].split(":")||{};p={host:c[0],port:c[1],path:f[1]?f[3]:f[2]+f[3],query:f[4],fragment:f[5],hash:p.fragment}}else p={host:f.hostname,port:f.port,path:f.pathname,query:f.search.replace(/^\?/,""),fragment:f.hash.replace(/^#/,""),hash:p.fragment};return"all"===t?p:p[t]||""}if("domain"===t){var m=f.hostname||f[1].split(":")[0];if(/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/.test(m))return m;var u=m.split(".");return u.length>2&&u.shift(),u.join(".")}}});